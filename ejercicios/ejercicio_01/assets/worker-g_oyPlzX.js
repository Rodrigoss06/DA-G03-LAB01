(function(){"use strict";function c(t,n){return Math.random()*(n-t)+t}function f(t,n){return Math.floor(c(t,n))}function w(t,n,i){const[o,r]=n,[h,z]=i;return(t-o)*(z-h)/(r-o)+h}let u=[],a=[0,0],M=30,x="rgb(255, 255, 255)",l,e,s=1,d=p(),m=!1,g;const D=[.5,2],T=[.2,.7],y=[-10,10],A=.1;function p(){return"performance"in self?performance.now():Date.now()}function R(){return{position:[f(0,a[0]),f(0,a[1])],speed:[c(...y),c(...y)],targetAlpha:c(...T),size:f(...D),alpha:0}}function _({position:t,size:n}){const[i,o]=t,r=i<-n||i>a[0]+n,h=o<-n||o>a[1]+n;return r||h}function b(t){e.clearRect(0,0,a[0],a[1]),e.setTransform(s,0,0,s,0,0),u=u.map((n,i)=>{if(m&&(n.alpha-=A*2*t,n.alpha<=0))return R();const[o,r]=n.position,h=[o-n.size,a[0]-o-n.size,r-n.size,a[1]-r-n.size],z=w(Math.min(...h),[0,20],[0,1]),P=Number(Math.max(z,0).toFixed(2));P>1?(n.alpha+=A*t,n.alpha=Math.min(n.alpha,n.targetAlpha)):n.alpha=n.targetAlpha*P;const[O,S]=n.speed;return n.position[0]+=O*t,n.position[1]+=S*t,n.alpha<n.targetAlpha&&(n.alpha+=A*t,n.alpha=Math.min(n.alpha,n.targetAlpha)),_(n)?R():(F(n),n)})}function F(t){const[n,i]=t.position;e.beginPath();const o=e.globalAlpha;e.arc(n,i,t.size,0,2*Math.PI),e.fillStyle=x,e.globalAlpha=t.alpha,e.fill(),e.globalAlpha=o}function I(t){a=[l.width,l.height],M=parseInt(t.data.quantity),x=t.data.color,u=Array.from({length:M},R),console.log(u),e.canvas.width=a[0],e.canvas.height=a[1],e.scale(s,s),g&&cancelAnimationFrame(g),E()}function N(t){m=!1,a=[t.data.width,t.data.height],l.width=a[0]*s,l.height=a[1]*s}function L(){m=!0}function H(t){l=t.data.canvas,e=l.getContext("2d"),s=t.data.pixelRatio,e.scale(s,s)}function E(){const t=p(),n=(t-d)/1e3;d=t,b(n),g=requestAnimationFrame(E)}d=p(),self.onmessage=t=>{const n={setup:H,init:I,"on-resize":L,resize:N},i=t.data.type,o=n[i];o(t)}})();
