var d=v;function v(a,e,t){var i=null,n=null,r=function(){i&&(clearTimeout(i),n=null,i=null)},c=function(){var s=n;r(),s&&s()},o=function(){if(!e)return a.apply(this,arguments);var s=this,h=arguments,l=t&&!i;if(r(),n=function(){a.apply(s,h)},i=setTimeout(function(){if(i=null,!l){var u=n;return n=null,u()}},e),l)return n()};return o.cancel=r,o.flush=c,o}class f extends HTMLElement{static observedAttributes=["quantity","color"];worker;canvas;container=null;constructor(){super(),this.canvas=document.createElement("canvas"),this.attachShadow({mode:"open"}).appendChild(this.canvas),this.style.display="block",this.canvas.style.display="block",this.worker=new Worker(new URL("/assets/worker-g_oyPlzX.js",import.meta.url),{type:"module"})}connectedCallback(){this.container=this.parentElement;const e=this.canvas.transferControlToOffscreen();this.worker.postMessage({type:"setup",canvas:e,pixelRatio:window.devicePixelRatio??1},[e]),this.bindResizeEvents(),this.initialize()}attributeChangedCallback(e,t,i){t!==null&&this.initialize()}bindResizeEvents(){const e=d(()=>{this.initialize()},200),t=()=>{this.worker.postMessage({type:"on-resize"}),e()};this.container?new ResizeObserver(t).observe(this.container):window.addEventListener("resize",t),window.addEventListener("orientationchange",t)}initialize(){this.resize(),this.worker.postMessage({type:"init",quantity:this.getAttribute("quantity")??"30",color:this.getAttribute("color")??"rgb(255, 255, 255)"}),this.style.animation="fade-in 0.5s forwards"}resize(){const[e,t]=this.container?[this.container.offsetWidth,this.container.offsetHeight]:[window.innerWidth,window.innerHeight];this.style.width=`${e}px`,this.style.height=`${t}px`,this.canvas.style.width=`${e}px`,this.canvas.style.height=`${t}px`,this.worker.postMessage({type:"resize",width:e,height:t})}disconnectedCallback(){this.worker.terminate()}}export{f as ParticleCanvas};
